# ドメイン用語集 (Domain Glossary)

本プロジェクト（Master Mind Sanctuary）で使用される主要な用語とその定義をまとめます。開発者はこれらの用語をコード（クラス名、変数名）やコミュニケーションで統一して使用する必要があります。

## コア・ドメイン (Core Domain)

### Chat Message (チャットメッセージ)
- **定義**: ユーザーまたはAIエージェントによって発言された単一のメッセージ。
- **構成要素**:
    - **ID**: メッセージを一意に識別する識別子。
    - **Role (役割)**: メッセージの発信者。`USER` (ユーザー) または `MODEL` (AI) のいずれか。
    - **Content (内容)**: メッセージのテキスト本文。
    - **SentAt (送信日時)**: メッセージが送信された日時。
- **関連クラス**: `app.domain.aggregates.chat_history.ChatMessage`

### System Instruction (システム指示)
- **定義**: AIエージェントの人格や振る舞いを規定するための指示（プロンプト）。AIプロバイダーごとに設定可能。
- **振る舞い**:
    - 各プロバイダー（Gemini, GPTなど）に対し、常に1つの「アクティブ」な指示が存在する。
    - 対話生成時に自動的にコンテキストとしてAIに渡される。
- **関連クラス**: `app.domain.aggregates.system_instruction.SystemInstruction`

### AI Provider (AIプロバイダー)
- **定義**: AI機能を提供する外部サービス。
- **値の例**: `GEMINI` (Google), `OPENAI` (ChatGPT)。
- **関連クラス**: `app.domain.value_objects.ai_provider.AIProvider`

## アプリケーション・アーキテクチャ用語 (Architectural Terms)

### Mediator (メディエーター)
- **定義**: コマンドやクエリを適切なハンドラーにルーティングする仲介役。呼び出し元（Botなど）と処理の実装（UseCase）を疎結合にするために使用される。
- **使用法**: `Mediator.send_async(request)` の形式で呼び出す。

### Use Case / Handler (ユースケース / ハンドラー)
- **定義**: 特定のビジネス要件（「メッセージに応答する」「設定を変更する」など）を実現する一連の処理ロジック。
- **役割**: ドメインオブジェクトの取得、ビジネスルールの適用、インフラストラクチャサービスの呼び出しを調整する。

### Unit of Work (UoW)
- **定義**: データベースへの変更を一括で管理するトランザクション境界。
- **役割**: 複数のリポジトリ操作（保存、更新）を1つの原子的な操作としてコミットまたはロールバックすることを保証する。
